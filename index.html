<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="css/style.css" />
        <title>Kalimba Song Composer</title>
    </head>
    <body>
        <h1>Kalimba Song Composer</h1>

        <div id="song">
            <form id="upload-song">
                <label>upload song: <input type="file" name="upload" /></label>
                <button type="submit">upload</button>
            </form>
            <div id="song-buttons">
                <button id="save-song">save song</button>
                <button id="new-song">new song</button>
            </div>
            <form id="time-sig"></form>
            <form id="add-notes" class="q"></form>
            <div id="composed-notes"></div>
        </div>

        <script type="module">
            import Song from "./classes/Song.js";
            import getTimeSigFormHTML from "./scripts/time-sig.js";
            import getAddNotesFormHTML from "./scripts/add-notes.js";
            import {
                handleTimeSigFormSubmit,
                handleAddNotesFormSubmit,
                handleChangeNoteLength,
                handleClearInputs,
                handleNewSong,
                handleUploadSong,
            } from "./scripts/handlers.js";

            let song = new Song();

            const timeSig = document.querySelector("#time-sig");
            timeSig.innerHTML = getTimeSigFormHTML();
            timeSig.onsubmit = (e) => handleTimeSigFormSubmit(e, song);

            const addNotesForm = document.querySelector("#add-notes");
            addNotesForm.innerHTML = getAddNotesFormHTML();
            addNotesForm.onsubmit = (e) => handleAddNotesFormSubmit(e, song);

            document.querySelector("#note-length").onchange =
                handleChangeNoteLength;

            document.querySelector("#clear").onclick = handleClearInputs;

            document.querySelector("#save-song").onclick = () =>
                song.writeFile();

            document.querySelector("#upload-song").onsubmit = async (e) =>
                (song = await handleUploadSong(e));

            document.querySelector("#new-song").onclick = () =>
                (song = handleNewSong(song));
        </script>
    </body>
</html>
